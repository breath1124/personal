---
import { NAV, SITE } from "../config/site";

const base = import.meta.env.BASE_URL;
const pathname = Astro.url.pathname;

function hrefFor(path: string) {
  return `${base}${path.replace(/^\//, "")}`;
}

function isActive(path: string) {
  const href = hrefFor(path);
  if (path === "/") return pathname === href;
  return pathname.startsWith(href);
}
---

<header class="site-header">
  <a class="brand" href={base}>{SITE.title}</a>
  <nav class="nav" aria-label="主导航">
    {
      NAV.map((item) => (
        <a
          class={`nav-link${isActive(item.href) ? " is-active" : ""}`}
          href={hrefFor(item.href)}
          aria-current={isActive(item.href) ? "page" : undefined}
        >
          {item.label}
        </a>
      ))
    }
    <a class="nav-link" href={`${base}rss.xml`}>RSS</a>
  </nav>
</header>
